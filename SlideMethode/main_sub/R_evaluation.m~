function [dis_Rim C_data] = R_evaluation(data,mean_matrix,sw)
[m n] = size(data) ;
Dis = diag(ones(m,1)*0.05) ;
C_data = cell(1,n) ;

for k = 1:(n-sw)
    y(k)= mat2cell((normdata(:,(k:1:(k+sw))))*(normdata(:,(k:1:(k+sw))))',m);  % each array is M*M  
end

for i = 1:n 
    C_data(i) = mat2cell(data(:,i)*data(:,i)'+Dis,m) ;
end
dis_Rim = ones(1,n) ;
for i = 1:n
    dis_Rim(i) = sqrt(sum(log(eig(C_data{i},mean_matrix)).^2));
end
end